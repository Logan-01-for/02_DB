ALTER SESSION SET "_ORACLE_SCRIPT" = TRUE; 
--구버전 오라클로 유저 만드는 구문

CREATE USER kh_shop IDENTIFIED BY 1234; 

GRANT CREATE SESSION TO kh_shop; -- 유저 만드는 권한

GRANT CREATE TABLE TO kh_shop; -- 테이블 만드는 권한

ALTER USER kh_shop DEFAULT TABLESPACE
SYSTEM QUOTA UNLIMITED ON SYSTEM; --테이블 공간 할당 권한

CREATE TABLE CATEGORIES(
				CATEGORY_ID NUMBER PRIMARY KEY,
				CATEGORY_NAME VARCHAR2(100) UNIQUE
);

CREATE TABLE PRODUCTS(
		PRODUCT_ID NUMBER PRIMARY KEY,
		PRODUCT_NAME VARCHAR2(100) NOT NULL,
		CATEGORY NUMBER,
		PRICE NUMBER DEFAULT 0,
		STOCK_QUANTITY NUMBER DEFAULT 0,
		CONSTRAINT FK_CATEGORY FOREIGN KEY (CATEGORY) REFERENCES
		CATEGORIES(CATEGORY_ID)
);

CREATE TABLE CUSTOMERS(
	CUSTOMER_ID NUMBER PRIMARY KEY,
	NAME VARCHAR2(20) NOT NULL,
	GENDER CHAR(3) CHECK (GENDER IN ('남','여')),
	ADDRESS VARCHAR2(100),
	PHONE VARCHAR2(30)
);

CREATE TABLE ORDERS (
    ORDER_ID NUMBER PRIMARY KEY,                          
    ORDER_DATE DATE DEFAULT SYSDATE,                        
    STATUS CHAR(1) DEFAULT 'N' CHECK (STATUS IN ('Y', 'N')) , 
    CUSTOMER_ID NUMBER,                                     
    CONSTRAINT FK_CUSTOMERS FOREIGN KEY (CUSTOMER_ID) 
    REFERENCES CUSTOMERS(CUSTOMER_ID)
		ON DELETE CASCADE
    );

SELECT * FROM CATEGORIES;

INSERT INTO CATEGORIES VALUES('1','스마트폰');
INSERT INTO CATEGORIES VALUES('2','TV');
INSERT INTO CATEGORIES VALUES('3','Gaming');

SELECT * FROM PRODUCTS;

INSERT INTO PRODUCTS VALUES(101, 'Apple iPhone 12', '1', '1500000','30');
INSERT INTO PRODUCTS VALUES(102, 'Samsung Galaxy S24', '1', '1800000','50');
INSERT INTO PRODUCTS VALUES(201, 'LG OLED TV', '2', '3600000','10');
INSERT INTO PRODUCTS VALUES(301, 'Sony PlayStation 5', '3', '7000000','15');

SELECT * FROM CUSTOMERS;

INSERT INTO CUSTOMERS VALUES(1, '홍길동', '남', '서울시 성동구 왕십리','010-1111-2222');
INSERT INTO CUSTOMERS VALUES(2, '유관순', '여', '서울시 종로구 안국동','010-3333-1111');

SELECT * FROM ORDERS;
INSERT INTO ORDERS VALUES(576, '2024-02-29', 'N', 1);
INSERT INTO ORDERS VALUES(978, '2024-03-11', 'Y', 2);
INSERT INTO ORDERS VALUES(777, '2024-03-11', 'N', 2);
INSERT INTO ORDERS VALUES(134, '2022-12-25', 'Y', 1);
INSERT INTO ORDERS VALUES(499, '2020-01-03', 'Y', 1);

SELECT * FROM ORDER_DETAILS;

INSERT INTO ORDER_DETAILS VALUES(111, 576, 101, 1, 1500000);
INSERT INTO ORDER_DETAILS VALUES(222, 978, 201, 2, 3600000);
INSERT INTO ORDER_DETAILS VALUES(333, 978, 102, 1, 1800000);
INSERT INTO ORDER_DETAILS VALUES(444, 777, 301, 5, 700000);
INSERT INTO ORDER_DETAILS VALUES(555, 134, 102, 1, 1800000);
INSERT INTO ORDER_DETAILS VALUES(666, 499, 201, 3, 3600000);

SELECT NAME 고객명, ORDER_DATE 주문일, STATUS 처리상태 
FROM CUSTOMERS
LEFT JOIN ORDERS ON(CUSTOMER_ID=ORDER_ID);